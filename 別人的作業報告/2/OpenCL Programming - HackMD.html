<!DOCTYPE html>
<!-- saved from url=(0040)https://hackmd.io/@karta134033/rJm2caS6v -->
<html lang="zh-TW"><script async="" src="./OpenCL Programming - HackMD_files/gtm.js.下載"></script><script id="allow-copy_script">(function agent() {
    let unlock = false
    document.addEventListener('allow_copy', (event) => {
      unlock = event.detail.unlock
    })

    const copyEvents = [
      'copy',
      'cut',
      'contextmenu',
      'selectstart',
      'mousedown',
      'mouseup',
      'mousemove',
      'keydown',
      'keypress',
      'keyup',
    ]
    const rejectOtherHandlers = (e) => {
      if (unlock) {
        e.stopPropagation()
        if (e.stopImmediatePropagation) e.stopImmediatePropagation()
      }
    }
    copyEvents.forEach((evt) => {
      document.documentElement.addEventListener(evt, rejectOtherHandlers, {
        capture: true,
      })
    })
  })()</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="csrf-token" content="NqGIEdyi-97mKgzoseMhfA88yhm9l6e7Q4Ls">
    
    
    <meta name="description" content="  # OpenCL Programming  ## Q1  &gt;(5 points): Explain your implementation. How do you optimize the per">
    
    <title>OpenCL Programming - HackMD</title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
	<link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">
    
<script nonce="">
  window.domain = 'hackmd.io'
  window.urlpath = ''
  window.debug = false
  window.version = '1.3.0'
  window.brand = 'HackMD'

  
  window.NOTE_ID = 'lRYCaP63TCihJMt8a_S-rQ'
  

  window.GOOGLE_API_KEY = 'AIzaSyCjSrqWHhmWJnoI7JlD88XDSaBgiKbaenA'
  window.GOOGLE_CLIENT_ID = '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com'
  window.DROPBOX_APP_KEY = 'rdoizrlnkuha23r'
  
  window.PLANTUML_SERVER = 'https://ptuml.hackmd.io'

  window.ASSET_URL = 'https://assets.hackmd.io'

  window.USER_CAN_CREATE_TEAM = true
  window.USER_CAN_DELETE_ACCOUNT = true
  window.USER_DELETE_ACCOUNT_VIA_EMAIL = true
  window.PAYMENT_ENABLED = true
  window.PAYMENT_PROMOTION_BANNER_ENABLED = false
  window.GITHUB_SYNC_ENABLED = true
  window.GITLAB_SYNC_ENABLED = false
  window.GITLAB_SYNC_BASE_URL = ''
  window.VCS_SYNC_MODE = 'github'
  window.VCS_PROVIDER_NAME = 'GitHub'
  window.FREE_TEAM_NUM = 20
  window.FREE_TEAM_MEMBER_NUM = 3
  window.FREE_PUBLIC_TEAM_NUM = 10
  
  window.EE_SITE_ENABLE = false
  window.EE_SITE_NAME = 'false'
  window.EE_SITE_LINK = 'false'
  window.EESITE_INFO = false
  window.ENTERPRISE_DISCOVERY_ENABLE = false
  window.ENTERPRISE_DISCOVERY_TEAM = true
  window.ENTERPRISE_DISCOVERY_NOTE = true
  window.ENTERPRISE_DISCOVERY_VIEW_PERMISSION = 'guest'
  
  window.ALLOW_ANONYMOUS = true
  window.ALLOW_ANONYMOUS_EDIT = false
  window.PUBLIC_OVERVIEW = false
  window.INTERNAL_PUBLIC_OVERVIEW = false
  window.FULL_TEXT_SEARCH_ENABLE = false
  window.ALGOLIA_SEARCH_ENABLE = true
  window.MARKETING_EMAIL_ENABLE = true
  
  
  window.API_MANAGEMENT_UI_ENABLE = true
  window.FEEDBACK_UI_ENABLE = true
  window.PUBLISH_ENABLE = true

  
  window.SHOW_HOT_NOTES = false
  

  
  window.HOT_NOTES_TIME_TYPE = 'week'
  

  
  window.SHOW_OVERVIEW = true
  

  
  window.MENTIONS = {}
  

  
  window.MENTION_ANCHORS = []
  

  
  window.COMMENT_ANCHORS = []
  

  
  window.IS_OWNER = false
  

  
  window.IS_TEAM_ADMIN = false
  

  

  
  window.USER_PROFILE = {"name":"楊子民","userpath":"sam1248105","photo":"https://graph.facebook.com/3226858230677250/picture?width=96","userid":"2c7be004-f01e-46bd-b2d6-7133e2372bb8"}
  

  
  window.VERSION_TIME = '1610552444235'
  

  
  window.canEdit = true
  

  
  window.canWriteComment = true
  
</script>


    
<!-- Google Tag Manager -->
<script nonce="">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KLW9Z3');</script>
<!-- End Google Tag Manager -->


    



<meta property="fb:app_id" content="1436904003272070">


    <meta name="twitter:image:src" content="https://lh3.googleusercontent.com/-8t6tJ5N_q9k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reKpEqiLF5J4yGnqMw6Ckn2daGTog/photo.jpg">


<meta name="twitter:site" content="@hackmdio">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="OpenCL Programming - HackMD">


    <meta name="twitter:description" content="  # OpenCL Programming  ## Q1  &gt;(5 points): Explain your implementation. How do you optimize the per">



    <meta property="og:image" content="https://lh3.googleusercontent.com/-8t6tJ5N_q9k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reKpEqiLF5J4yGnqMw6Ckn2daGTog/photo.jpg">


<meta property="og:site_name" content="HackMD">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenCL Programming - HackMD">


    <meta property="og:description" content="  # OpenCL Programming  ## Q1  &gt;(5 points): Explain your implementation. How do you optimize the per">


    <link rel="stylesheet" href="./OpenCL Programming - HackMD_files/emojify.min.css">
     <link href="./OpenCL Programming - HackMD_files/font-vendor.3af8242de4ff555af255.css" rel="stylesheet"><link href="./OpenCL Programming - HackMD_files/common-vendor.3f50d6443fc55574a09d.css" rel="stylesheet"><link href="./OpenCL Programming - HackMD_files/pretty-vendor.c152255c6001dfd89878.css" rel="stylesheet"><link href="./OpenCL Programming - HackMD_files/pretty.ffde640da59ec7941712.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
<![endif]-->

<style id="googleidentityservice_button_styles" nonce="">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b>.aZ2wEe>div{border-color:#4285f4}.P1ekSe-ZMv3u>div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u>div:nth-child(2),.P1ekSe-ZMv3u>div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{-webkit-border-radius:4px;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:background-color .218s,border-color .218s;transition:background-color .218s,border-color .218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{-webkit-border-radius:20px;border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{-webkit-border-radius:16px;border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{-webkit-border-radius:10px;border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:3px;border-top-left-radius:3px;-webkit-border-bottom-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:3px;border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:14px;border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:8px;border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex-direction:row;flex-direction:row;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color .218s;transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{-webkit-box-shadow:none;box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{-webkit-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:0;border-top-left-radius:0;-webkit-border-bottom-left-radius:0;border-bottom-left-radius:0;-webkit-border-top-right-radius:3px;border-top-right-radius:3px;-webkit-border-bottom-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><style>::-moz-focus-inner{border:0 !important;}:focus,.focus{outline: none !important;}</style><style></style><link rel="stylesheet" type="text/css" href="./OpenCL Programming - HackMD_files/fretboard.26d5e78e694dfbd67fb7.css"><link id="googleidentityservice" type="text/css" media="all" rel="stylesheet" href="./OpenCL Programming - HackMD_files/style"></head>

<body style="" data-new-gr-c-s-check-loaded="14.1089.0" data-gr-ext-installed="">
    <div class="ui-infobar container-fluid unselectable hidden-print comment-enabled">
        <div class="row">
            <div class="col-xs-12 ui-infobar-inner">
                <div class="ui-infobar__user-info">
                    <ul class="list-inline h-[28px] mb-0">
                        <li>
                            <div class="flex text-4 gap-[9px]">
                                
                                    <span class="flex items-center justify-center ui-owner" data-profile="karta134033">
                                         <a class="ui-user-icon m-0 inline-block w-[28px] h-[28px] user-card-popover" style="background-image: url(https://lh3.googleusercontent.com/-8t6tJ5N_q9k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reKpEqiLF5J4yGnqMw6Ckn2daGTog/photo.jpg);" target="_blank" href="https://hackmd.io/@karta134033" data-toggle="popover" data-original-title="" title=""></a>
                                    </span>
                                

                                <div class="flex flex-col items-start">
                                    
                                        <a class="font-bold text-gray-900 cursor-pointer ui-owner hover:underline user-card-popover" data-profile="karta134033" href="https://hackmd.io/@karta134033" data-toggle="popover" data-original-title="" title="">
                                            karta134033
                                        </a>
                                    


                                    <div class="flex">
                                        <div>
                                            <span class="ui-status-lastchange" title="2021年1月13日星期三 23:40">變更於 2 年前</span>
                                            <span class="ui-lastchange" data-createtime="1609058986973" data-updatetime="1610552444235"></span>
                                        </div>

                                        
                                            <a class="text-gray-400 hover:text-gray-400 focus:text-gray-400 ml-2.5" data-toggle="popover" data-placement="bottom" data-html="true" data-content="&lt;i class=&quot;fa fa-globe mr-1&quot; aria-hidden=&quot;true&quot; style=&quot;margin-top: 1px;&quot;&gt;&lt;/i&gt;公開筆記" data-trigger="focus" role="button" tabindex="0" data-original-title="" title="">
                                                <i class="fa fa-fw fa-globe" aria-hidden="true"></i>
                                            </a>
                                        

                                        <span class="ml-1 text-gray-400 ui-more-info hmd-dn" data-toggle="popover" data-original-title="" title="">
                                             <i class="fa fa-fw align-middle ui-connectedGithubIcon fa-github"></i>

                                            <div class="more-info-raw hmd-dn">
                                                <span class="ui-connectedGithub note-status-row hmd-dn">
                                                    <i class="fa ui-connectedGithubIcon fa-github"></i>
                                                    <a class="text-gray-600 ui-synced-text hover:text-gray-600 focus:text-gray-600">與 GitHub 同步</a>

                                                    
                                                </span>
                                            </div>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="items-center hmd-text-right ui-infobar__actions">
                    <ul class="mb-0 list-inline">
                        <li>
                            
                                <span class="community-button ui-like hidden-xs" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="讚賞">
                                    <i class="fa fa-fw"></i>
                                    <span class="count"></span>
                                </span>

                                <span class="community-button ui-bookmark hidden-xs" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="收藏">
                                    <i class="fa fa-fw"></i>
                                </span>

                                
                                    <div class="ui-notification dropdown ">
                                        <span id="notificationLabel" class="ui--subscribed hidden-xs" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                                            <div class="ui-notification-status community-button" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="訂閱">
                                                <i class="fa fa-fw fa-bell"></i>
                                            </div>
                                        </span>

                                        <ul class="dropdown-menu" aria-labelledby="notificationLabel">
                                            <li class="ui-notification-watch notification-menu-item ">
                                                <i class="fa fa-check fa-fw"></i>
                                                <i class="fa fa-bell fa-fw"></i>
                                                <div class="info">
                                                    <div class="title">
                                                        所有通知
                                                    </div>
                                                    <div class="description">
                                                        當有任何變更時將會收到通知
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="ui-notification-mention notification-menu-item ">
                                                <i class="fa fa-check fa-fw"></i>
                                                <i class="fa fa-at fa-fw"></i>
                                                <div class="info">
                                                    <div class="title">
                                                        提及我
                                                    </div>
                                                    <div class="description">
                                                        當有人提及我時才會收到通知
                                                    </div>
                                                </div>
                                            </li>

                                            <li class="divider"></li>
                                            <!--
                                                <li class="ui-notification-list notification-menu-item"><span><a href="#"><i class="fa fa-list-ul fa-fw"></i>我的訂閱列表</a></span></li>
                                            -->
                                            <li class="ui-notification-unsubscribe notification-menu-item"><i class="fa fa-bell-slash-o fa-fw"></i>取消訂閱</li>
                                        </ul>
                                        <span class="ui-notification-subscribe community-button hidden-xs" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="訂閱">
                                            <i class="fa fa-fw fa-bell-o"></i>
                                        </span>
                                    </div>
                                
                            
                        </li>

                        
                            <li>
                                <a href="https://hackmd.io/@karta134033/rJm2caS6v/edit?both" class="ui-edit btn btn-default btn-md"><i class="fa fa-pencil"></i> <span class="hidden-xs" style="margin-left: 3px">編輯</span></a>
                            </li>
                        
                    </ul>
                </div>

                <div class="clearfix"></div>
            </div>
        </div>
        
        <div class="ui-comment-app" id="hackmd-app" style="right: -45px; width: 45px;">
            <div id="comment-app"><div class="open-comments"><div><button class="ui-open-comments btn btn-default"><i class="fa fa-commenting" aria-hidden="true"></i><span class="text">0 篇留言</span></button></div><div style="display: none;"><div class="comment-settings" id="comment-settings"><img src="./OpenCL Programming - HackMD_files/comments-settings.svg" style="margin-right: 5px;"><div>留言設定</div></div></div></div><div class="comments-scroller"><div class="comments-containers"></div></div></div>
        </div>
        
    </div>

    <!-- Markdown rendered container -->
    <div id="doc" class="container-fluid markdown-body comment-enabled" data-hard-breaks="true"><h1 class="part" data-startline="5" data-endline="5" id="OpenCL-Programming" data-id="OpenCL-Programming"><a class="anchor hidden-xs" href="https://hackmd.io/@karta134033/rJm2caS6v#OpenCL-Programming" title="OpenCL-Programming" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="24" data-size="18">OpenCL Programming</span></h1><h2 class="part" data-startline="7" data-endline="7" id="Q1" data-id="Q1"><a class="anchor hidden-xs" href="https://hackmd.io/@karta134033/rJm2caS6v#Q1" title="Q1" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="47" data-size="2">Q1</span></h2><blockquote class="part" data-startline="8" data-endline="8">
<p data-position="52" data-size="0"><span data-position="52" data-size="92">(5 points): Explain your implementation. How do you optimize the performance of convolution?</span></p>
</blockquote><h3 class="part" data-startline="10" data-endline="10" id="–作法–" data-id="–作法–"><a class="anchor hidden-xs" href="https://hackmd.io/@karta134033/rJm2caS6v#%E2%80%93%E4%BD%9C%E6%B3%95%E2%80%93" title="–作法–" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="150" data-size="6">–作法–</span></h3><ol class="part" data-startline="11" data-endline="112" data-position="157" data-size="0">
<li class="" data-startline="11" data-endline="20" data-position="160" data-size="0">
<p data-position="157" data-size="0"><strong data-position="160" data-size="0"><span data-position="162" data-size="8">將傳輸資料量縮小</span></strong><br>
<span data-position="174" data-size="30">原本傳入的圖片為"float"型態，佔用空間為4bytes。</span><br>
<span data-position="206" data-size="49">圖像處理中常見的型態為"uchar"，一般是指unsigned char，佔用空間為1bytes。</span><br>
<span data-position="257" data-size="37">從助教的"readImage()"function也可以得知讀入的圖片是以</span><strong data-position="306" data-size="0"><span data-position="296" data-size="16">uchar做儲存再轉為float</span></strong><span data-position="314" data-size="9">，因此確實可以將"</span><strong data-position="335" data-size="0"><span data-position="325" data-size="2">輸入</span></strong><span data-position="329" data-size="14">"圖片轉為uchar的型態。</span><br>
<span data-position="345" data-size="3">雖然"</span><strong data-position="364" data-size="0"><span data-position="350" data-size="2">輸出</span></strong><span data-position="354" data-size="23">"圖片的數值最後也是以uchar來表示，但做"</span><strong data-position="393" data-size="0"><span data-position="379" data-size="25">Diff ratio"的比較時是以float做比較</span></strong><span data-position="406" data-size="57">，所以沒辦法直接將格式由floar轉為uchar(直接轉的話雖然圖片是正確的，但Diff ratio會無法通過)。</span></p>
<pre><code class="c hljs"><span class="token keyword">float</span> <span class="token operator">*</span>inputImage 改為 <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>inputImage
</code></pre>
</li>
<li class="" data-startline="21" data-endline="51" data-position="557" data-size="0">
<p data-position="554" data-size="0"><strong data-position="557" data-size="0"><span data-position="559" data-size="9">修改for迴圈寫法</span></strong><br>
<span data-position="572" data-size="46">原先的for迴圈寫法會不斷的做if判斷，檢查計算的內容有沒有超出圖片邊界，速度上會慢上許多。</span><br>
<span data-position="620" data-size="4">原做法:</span></p>
<pre><code class="c hljs"><span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token operator">=</span> <span class="token operator">-</span>halffilterSize<span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> halffilterSize<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>l <span class="token operator">=</span> <span class="token operator">-</span>halffilterSize<span class="token punctuation">;</span> l <span class="token operator">&lt;=</span> halffilterSize<span class="token punctuation">;</span> l<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> k <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> i <span class="token operator">+</span> k <span class="token operator">&lt;</span> imageHeight <span class="token operator">&amp;&amp;</span>   <span class="token comment">// &lt;--持續判斷</span>
            j <span class="token operator">+</span> l <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">+</span> l <span class="token operator">&lt;</span> imageWidth<span class="token punctuation">)</span><span class="token punctuation">{</span>
            sum <span class="token operator">+=</span> inputImage<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> imageWidth <span class="token operator">+</span> j <span class="token operator">+</span> l<span class="token punctuation">]</span> <span class="token operator">*</span>
                filter<span class="token punctuation">[</span><span class="token punctuation">(</span>k <span class="token operator">+</span> halffilterSize<span class="token punctuation">)</span> <span class="token operator">*</span> filterWidth <span class="token operator">+</span>l <span class="token operator">+</span> halffilterSize<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p data-position="1063" data-size="0"><span data-position="1067" data-size="41">原本的作法可以改良為將k, l的開始與結束位置在之前就計算好再帶入for的條件中。</span><br>
<span data-position="1110" data-size="4">改良後:</span></p>
<pre><code class="c hljs"><span class="token keyword">int</span> k_start <span class="token operator">=</span> <span class="token operator">-</span>halffilterSize <span class="token operator">+</span> row <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span>halffilterSize <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment">// 計算起點</span>
<span class="token keyword">int</span> k_end <span class="token operator">=</span> halffilterSize <span class="token operator">+</span> row <span class="token operator">&lt;</span> imageHeight <span class="token operator">?</span> halffilterSize <span class="token operator">:</span>  <span class="token comment">// 計算終點</span>
    halffilterSize <span class="token operator">+</span> row <span class="token operator">-</span> imageHeight <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> l_start <span class="token operator">=</span> <span class="token operator">-</span>halffilterSize <span class="token operator">+</span> col <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span>halffilterSize <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> l_end <span class="token operator">=</span> halffilterSize <span class="token operator">+</span> col <span class="token operator">&lt;</span> imageWidth <span class="token operator">?</span> halffilterSize <span class="token operator">:</span> 
    halffilterSize <span class="token operator">+</span> col <span class="token operator">-</span> imageWidth <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> k_start<span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> k_end<span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> l_start<span class="token punctuation">;</span> l <span class="token operator">&lt;=</span> l_end<span class="token punctuation">;</span> <span class="token operator">++</span>l<span class="token punctuation">)</span> 
        sum <span class="token operator">+=</span> inputImage<span class="token punctuation">[</span><span class="token punctuation">(</span>row <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> imageWidth <span class="token operator">+</span> col <span class="token operator">+</span> l<span class="token punctuation">]</span> <span class="token operator">*</span> 
            shared_filter<span class="token punctuation">[</span><span class="token punctuation">(</span>k <span class="token operator">+</span> halffilterSize<span class="token punctuation">)</span> <span class="token operator">*</span> filterWidth <span class="token operator">+</span> l <span class="token operator">+</span> halffilterSize<span class="token punctuation">]</span><span class="token punctuation">;</span>

</code></pre>
</li>
<li class="" data-startline="52" data-endline="55" data-position="1784" data-size="0">
<p data-position="1781" data-size="0"><strong data-position="1784" data-size="0"><span data-position="1786" data-size="12">修改filter的作用域</span></strong><br>
<span data-position="1803" data-size="68">每個thread都會使用到相同的filter，頻繁的讀取資料會拖慢kernel速度，因此將filter拷貝到速度較快的"__local"中。</span><br>
<span data-position="1878" data-size="77">除此之外，有try過將圖片的內容依照group的id拷貝對應的區塊到"__local"中，但效能上並未有顯著提升。可能是切的方式還不夠完整，因此沒放入報告中。</span></p>
</li>
<li class="" data-startline="56" data-endline="89" data-position="1972" data-size="0">
<p data-position="1969" data-size="0"><strong data-position="1972" data-size="0"><span data-position="1974" data-size="11">修剪filter的大小</span></strong><span data-position="1987" data-size="14"> (CUDA只實作到此版本)</span><br>
<font color="red"><span data-position="2021" data-size="36">此方式是"動態"修改的方式，若不符合修改原則則會以原filter做為輸入</span></font><br>
<span data-position="2066" data-size="25">檢查filter2.csv與filter3.csv</span></p>
<pre><code class="t hljs"><span class="hljs-comment">// filter2</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> 
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> 
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> 
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> 
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> 
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> 
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>

<span class="hljs-comment">// filter3</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
</code></pre>
<p data-position="2352" data-size="0"><span data-position="2356" data-size="65">可以發現filter的外圈都是"0"，等於說會影響卷積結果的部分都只有中間 3 * 3的內容，因此可以將這兩個filter分別修剪為</span></p>
<pre><code class="t hljs"><span class="hljs-comment">// filter2</span>
<span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>
<span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">2</span>
<span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> 

<span class="hljs-comment">// filter3</span>
<span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> 
<span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> 
<span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> 
</code></pre>
</li>
<li class="" data-startline="90" data-endline="104" data-position="2548" data-size="0">
<p data-position="2545" data-size="0"><strong data-position="2548" data-size="0"><span data-position="2550" data-size="6">unroll</span></strong><br>
<span data-position="2560" data-size="13">從上一點可得知filter</span><strong data-position="2577" data-size="0"><span data-position="2575" data-size="2">如果</span></strong><span data-position="2579" data-size="47">最後是3 * 3的結果，for迴圈也會固定是3 * 3的內容，根據此想法可以將原本卷積的部分改寫為</span></p>
<pre><code class="c hljs"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> k <span class="token operator">=</span> k_start<span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> k_end<span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span> l <span class="token operator">=</span> l_start<span class="token punctuation">;</span>
    sum <span class="token operator">+=</span> inputImage<span class="token punctuation">[</span><span class="token punctuation">(</span>row <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> IMAGE_W <span class="token operator">+</span> col <span class="token operator">+</span> l<span class="token punctuation">]</span> <span class="token operator">*</span> 
        shared_filter<span class="token punctuation">[</span><span class="token punctuation">(</span>k <span class="token operator">+</span> HALF_FILTER_W<span class="token punctuation">)</span> <span class="token operator">*</span> FILTER_W <span class="token operator">+</span> l<span class="token operator">++</span> <span class="token operator">+</span> HALF_FILTER_W<span class="token punctuation">]</span><span class="token punctuation">;</span>
    sum <span class="token operator">+=</span> inputImage<span class="token punctuation">[</span><span class="token punctuation">(</span>row <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> IMAGE_W <span class="token operator">+</span> col <span class="token operator">+</span> l<span class="token punctuation">]</span> <span class="token operator">*</span> 
        shared_filter<span class="token punctuation">[</span><span class="token punctuation">(</span>k <span class="token operator">+</span> HALF_FILTER_W<span class="token punctuation">)</span> <span class="token operator">*</span> FILTER_W <span class="token operator">+</span> l<span class="token operator">++</span> <span class="token operator">+</span> HALF_FILTER_W<span class="token punctuation">]</span><span class="token punctuation">;</span>
    sum <span class="token operator">+=</span> inputImage<span class="token punctuation">[</span><span class="token punctuation">(</span>row <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> IMAGE_W <span class="token operator">+</span> col <span class="token operator">+</span> l<span class="token punctuation">]</span> <span class="token operator">*</span> 
        shared_filter<span class="token punctuation">[</span><span class="token punctuation">(</span>k <span class="token operator">+</span> HALF_FILTER_W<span class="token punctuation">)</span> <span class="token operator">*</span> FILTER_W <span class="token operator">+</span> l <span class="token operator">+</span> HALF_FILTER_W<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p data-position="3148" data-size="0"><span data-position="3152" data-size="52">不過，filter有可能無法修剪為3 * 3，如果不是3 * 3的內容，則會照著原本的for loop方式。</span></p>
</li>
<li class="" data-startline="105" data-endline="110" data-position="3211" data-size="0">
<p data-position="3208" data-size="0"><strong data-position="3211" data-size="0"><span data-position="3213" data-size="17">檢查filter是否是預先設定好的</span></strong><br>
<span data-position="3235" data-size="59">實做Open CL版本的內容時意外發現，若能在__kernel定義預先要使用的filter，再根據傳入的filter判斷，</span><strong data-position="3300" data-size="0"><span data-position="3298" data-size="48">若傳入的filter與預先定義好的filter完全相同，則直接使用預先定義好的filter做卷積</span></strong><span data-position="3348" data-size="38">的方法在速度上會快上許多(總執行時間大概差0.05ms ~ 0.12ms)。</span></p>
<p data-position="3395" data-size="0"><font color="red"><span data-position="3417" data-size="53">若傳入的filter與預先訂義好的filter內容不同，卷積時的filter則會以傳入的filter為主。</span></font><br>
<span data-position="3479" data-size="39">不過此優化方式在cuda卻沒有明顯差異，所以在cuda的實作上並未加入此功能。</span></p>
</li>
<li class="" data-startline="111" data-endline="112" data-position="3530" data-size="0">
<p data-position="3527" data-size="0"><s data-position="3530" data-size="0"><strong data-position="3532" data-size="0"><span data-position="3534" data-size="11">將資料傳輸方式改為異步</span></strong></s><span data-position="3549" data-size="1"> </span><font color="red"><span data-position="3568" data-size="28">使用non-blocking機制，不符合作業規定，已棄用</span></font></p>
</li>
</ol><h3 class="part" data-startline="113" data-endline="113" id="–測試–" data-id="–測試–"><a class="anchor hidden-xs" href="https://hackmd.io/@karta134033/rJm2caS6v#%E2%80%93%E6%B8%AC%E8%A9%A6%E2%80%93" title="–測試–" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="3611" data-size="6">–測試–</span></h3><ol class="part" data-startline="114" data-endline="189" data-position="3618" data-size="0">
<li class="" data-startline="114" data-endline="138" data-position="3621" data-size="0">
<p data-position="3618" data-size="0"><span data-position="3621" data-size="18">測試不同的圖片(大小為600*400)</span></p>
<ul>
<li class="" data-startline="115" data-endline="122" data-position="3647" data-size="0">
<p data-position="3641" data-size="0"><span data-position="3647" data-size="7">filter1</span></p>
<ul>
<li class="" data-startline="116" data-endline="117" data-position="3665" data-size="0"><span data-position="3665" data-size="3">卷積前</span><br>
<img src="./OpenCL Programming - HackMD_files/3Td6Ehf.png" alt="" class="" data-position="3671" data-size="36" loading="lazy"></li>
<li class="" data-startline="118" data-endline="119" data-position="3728" data-size="0"><span data-position="3728" data-size="3">卷積後</span><br>
<img src="./OpenCL Programming - HackMD_files/RjbDCbC.png" alt="" class="" data-position="3734" data-size="36" loading="lazy"></li>
<li class="" data-startline="120" data-endline="122" data-position="3791" data-size="0"><span data-position="3791" data-size="2">結果</span><br>
<img src="./OpenCL Programming - HackMD_files/EK2sYz2.png" alt="" class="" data-position="3796" data-size="36" loading="lazy"></li>
</ul>
</li>
<li class="" data-startline="123" data-endline="130" data-position="3858" data-size="0">
<p data-position="3852" data-size="0"><span data-position="3858" data-size="7">filter2</span></p>
<ul>
<li class="" data-startline="124" data-endline="125" data-position="3876" data-size="0"><span data-position="3876" data-size="3">卷積前</span><br>
<img src="./OpenCL Programming - HackMD_files/k8fE4SW.png" alt="" class="" data-position="3882" data-size="36" loading="lazy"></li>
<li class="" data-startline="126" data-endline="127" data-position="3939" data-size="0"><span data-position="3939" data-size="3">卷積後</span><br>
<img src="./OpenCL Programming - HackMD_files/JK4omZc.png" alt="" class="" data-position="3945" data-size="36" loading="lazy"></li>
<li class="" data-startline="128" data-endline="130" data-position="4002" data-size="0"><span data-position="4002" data-size="2">結果</span><br>
<img src="./OpenCL Programming - HackMD_files/fghCRKX.png" alt="" class="" data-position="4007" data-size="36" loading="lazy"></li>
</ul>
</li>
<li class="" data-startline="131" data-endline="138" data-position="4073" data-size="0">
<p data-position="4067" data-size="0"><span data-position="4073" data-size="7">filter3</span></p>
<ul>
<li class="" data-startline="132" data-endline="133" data-position="4091" data-size="0"><span data-position="4091" data-size="3">卷積前</span><br>
<img src="./OpenCL Programming - HackMD_files/eUlt5OQ.png" alt="" class="" data-position="4097" data-size="36" loading="lazy"></li>
<li class="" data-startline="134" data-endline="135" data-position="4154" data-size="0"><span data-position="4154" data-size="3">卷積後</span><br>
<img src="./OpenCL Programming - HackMD_files/sQwCJGx.png" alt="" class="" data-position="4160" data-size="36" loading="lazy"></li>
<li class="" data-startline="136" data-endline="138" data-position="4221" data-size="0"><span data-position="4221" data-size="2">結果</span><br>
<img src="./OpenCL Programming - HackMD_files/jeDZ6v5.png" alt="" class="" data-position="4226" data-size="36" loading="lazy"></li>
</ul>
</li>
</ul>
</li>
<li class="" data-startline="139" data-endline="189" data-position="4277" data-size="0">
<p data-position="4274" data-size="0"><span data-position="4277" data-size="10">測試不同filter</span><br>
<span data-position="4289" data-size="4">輸入圖片</span><br>
<img src="./OpenCL Programming - HackMD_files/G4nMbfs.png" alt="" class="" data-position="4295" data-size="36" loading="lazy"></p>
<ul>
<li class="" data-startline="142" data-endline="154" data-position="4344" data-size="0">
<p data-position="4338" data-size="0"><span data-position="4344" data-size="11">filter大小: 6</span></p>
<pre><code class="python hljs"><span class="hljs-number">6</span>
<span class="hljs-number">2</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">8</span>
</code></pre>
<p data-position="4516" data-size="0"><img src="./OpenCL Programming - HackMD_files/13qYKnD.png" alt="" class="" data-position="4524" data-size="36" loading="lazy"><br>
<img src="./OpenCL Programming - HackMD_files/7xeotb5.png" alt="" class="" data-position="4563" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="155" data-endline="170" data-position="4621" data-size="0">
<p data-position="4615" data-size="0"><span data-position="4621" data-size="11">filter大小: 9</span></p>
<pre><code class="python hljs"><span class="hljs-number">9</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">9</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">8</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> 
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> 
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">9</span>
<span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">3</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">8</span>
<span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> 
<span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-number">1</span> <span class="hljs-number">5</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span>  
</code></pre>
<p data-position="4912" data-size="0"><img src="./OpenCL Programming - HackMD_files/2rMYINz.png" alt="" class="" data-position="4920" data-size="36" loading="lazy"><br>
<img src="./OpenCL Programming - HackMD_files/ucTPrpn.png" alt="" class="" data-position="4959" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="171" data-endline="189" data-position="5013" data-size="0">
<p data-position="5007" data-size="0"><span data-position="5013" data-size="12">filter大小: 11</span></p>
<pre><code class="python hljs"><span class="hljs-number">11</span>
<span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>
<span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span>
<span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">1</span>      
</code></pre>
<p data-position="5403" data-size="0"><img src="./OpenCL Programming - HackMD_files/1aY99Gz.png" alt="" class="" data-position="5411" data-size="36" loading="lazy"><br>
<img src="./OpenCL Programming - HackMD_files/yVBlkP8.png" alt="" class="" data-position="5450" data-size="36" loading="lazy"></p>
</li>
</ul>
</li>
</ol><h3 class="part" data-startline="190" data-endline="190" id="–補充–" data-id="–補充–"><a class="anchor hidden-xs" href="https://hackmd.io/@karta134033/rJm2caS6v#%E2%80%93%E8%A3%9C%E5%85%85%E2%80%93" title="–補充–" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="5503" data-size="6">–補充–</span></h3><p class="part" data-startline="191" data-endline="191" data-position="5510" data-size="0"><span data-position="5510" data-size="26">報告闡述的版本可能還不夠通用，所以有實作其他的版本。</span></p><ul class="part" data-startline="192" data-endline="215">
<li class="" data-startline="192" data-endline="193" data-position="5539" data-size="0"><span data-position="5539" data-size="6">0.4940</span><font color="red"><span data-position="5563" data-size="28">使用non-blocking機制，不符合作業規定，已棄用</span></font><br>
<img src="./OpenCL Programming - HackMD_files/fircnWc.png" alt="" width="450" height="300" class="" data-position="5599" data-size="45" loading="lazy"></li>
<li class="" data-startline="194" data-endline="195" data-position="5647" data-size="0"><span data-position="5647" data-size="6">0.6047</span><font color="red"><span data-position="5671" data-size="28">使用non-blocking機制，不符合作業規定，已棄用</span></font><br>
<img src="./OpenCL Programming - HackMD_files/UwT3Q6h.png" alt="" width="450" height="300" class="" data-position="5707" data-size="45" loading="lazy"></li>
<li class="" data-startline="196" data-endline="197" data-position="5755" data-size="0"><span data-position="5755" data-size="6">0.7160</span><font color="red"><span data-position="5779" data-size="28">使用non-blocking機制，不符合作業規定，已棄用</span></font><br>
<img src="./OpenCL Programming - HackMD_files/2ZKn2Ve.png" alt="" width="450" height="300" class="" data-position="5815" data-size="45" loading="lazy"></li>
<li class="" data-startline="198" data-endline="199" data-position="5863" data-size="0"><span data-position="5863" data-size="6">0.8737</span><font color="red"><span data-position="5887" data-size="28">使用non-blocking機制，不符合作業規定，已棄用</span></font><br>
<img src="./OpenCL Programming - HackMD_files/VaraiOP.png" alt="" width="450" height="300" class="" data-position="5923" data-size="45" loading="lazy"></li>
<li class="" data-startline="200" data-endline="201" data-position="5971" data-size="0"><span data-position="5971" data-size="6">0.9363</span><font color="red"><span data-position="5995" data-size="28">使用non-blocking機制，不符合作業規定，已棄用</span></font><br>
<img src="./OpenCL Programming - HackMD_files/TBeWiLO.png" alt="" width="450" height="300" class="" data-position="6031" data-size="45" loading="lazy"></li>
<li class="" data-startline="202" data-endline="203" data-position="6079" data-size="0"><span data-position="6079" data-size="6">0.9783</span><font color="red"><span data-position="6103" data-size="28">使用non-blocking機制，不符合作業規定，已棄用</span></font><br>
<img src="./OpenCL Programming - HackMD_files/hb8UTWB.png" alt="" width="450" height="300" class="" data-position="6139" data-size="45" loading="lazy"></li>
<li class="" data-startline="204" data-endline="205" data-position="6187" data-size="0"><span data-position="6187" data-size="6">1.1607</span><br>
<img src="./OpenCL Programming - HackMD_files/B1vMeQd.png" alt="" width="450" height="300" class="" data-position="6194" data-size="45" loading="lazy"></li>
<li class="" data-startline="206" data-endline="207" data-position="6242" data-size="0"><span data-position="6242" data-size="6">1.2143</span><br>
<img src="./OpenCL Programming - HackMD_files/MUxP4oC.png" alt="" width="450" height="300" class="" data-position="6249" data-size="45" loading="lazy"></li>
<li class="" data-startline="208" data-endline="209" data-position="6297" data-size="0"><span data-position="6297" data-size="6">1.4953</span><br>
<img src="./OpenCL Programming - HackMD_files/SSiZktm.png" alt="" width="450" height="300" class="" data-position="6304" data-size="45" loading="lazy"></li>
<li class="" data-startline="210" data-endline="211" data-position="6352" data-size="0"><span data-position="6352" data-size="6">1.5847</span><br>
<img src="./OpenCL Programming - HackMD_files/WzTD7Da.png" alt="" width="450" height="300" class="" data-position="6359" data-size="45" loading="lazy"></li>
<li class="" data-startline="212" data-endline="215" data-position="6407" data-size="0"><span data-position="6407" data-size="6">2.1620</span><br>
<img src="./OpenCL Programming - HackMD_files/a8jb6it.png" alt="" width="450" height="300" class="" data-position="6414" data-size="45" loading="lazy"></li>
</ul><p class="part" data-startline="216" data-endline="216" data-position="6462" data-size="0"><span data-position="6462" data-size="22">以上的實作在優化上會有些許不同，但都會符合:</span></p><ul class="part" data-startline="217" data-endline="223">
<li class="" data-startline="217" data-endline="217" data-position="6487" data-size="0"><span data-position="6487" data-size="28">可測試不同的filter，不限制在3個測試的filter</span></li>
<li class="" data-startline="218" data-endline="220" data-position="6518" data-size="0"><span data-position="6518" data-size="19">filter大小不限(建議設定為奇數)</span><br>
<span data-position="6540" data-size="3">原因:</span><br>
<img src="./OpenCL Programming - HackMD_files/7GYJHDc.png" alt="" class="" data-position="6546" data-size="36" loading="lazy"></li>
<li class="" data-startline="221" data-endline="221" data-position="6589" data-size="0"><span data-position="6589" data-size="7">沒有預設輸出值</span></li>
<li class="" data-startline="222" data-endline="223" data-position="6599" data-size="0"><span data-position="6599" data-size="42">可以輸入不同的圖片大小，但長、寬須為8的倍數(因為kernel的執行單元設定為8*8)</span></li>
</ul><p class="part" data-startline="224" data-endline="224" data-position="6644" data-size="0"><span data-position="6644" data-size="16">若有問題會再提供助教其他的版本。</span></p><p class="part" data-startline="226" data-endline="228" data-position="6662" data-size="0"><span data-position="6662" data-size="23">還有一個0.0000違規的版本，放著做個紀念。</span><br>
<img src="./OpenCL Programming - HackMD_files/Q0tI6jY.png" alt="" class="" data-position="6686" data-size="36" loading="lazy"><br>
<span data-position="6723" data-size="15">測試的Script還因此壞掉了</span><img class="emoji" alt=":zany_face:" src="./OpenCL Programming - HackMD_files/zany_face.png" data-position="6718" data-size="11"></p><h2 class="part" data-startline="231" data-endline="231" id="Q2" data-id="Q2"><a class="anchor hidden-xs" href="https://hackmd.io/@karta134033/rJm2caS6v#Q2" title="Q2" smoothhashscroll=""><span class="octicon octicon-link"></span></a><span data-position="6755" data-size="2">Q2</span></h2><blockquote class="part" data-startline="232" data-endline="232">
<p data-position="6761" data-size="0"><span data-position="6761" data-size="193">(10 points): Rewrite the program using CUDA. (1) Explain your CUDA implementation, (2) plot a chart to show the performance difference between using OpenCL and CUDA, and (3) explain the result.</span></p>
</blockquote><ul class="part" data-startline="234" data-endline="361">
<li class="" data-startline="234" data-endline="326" data-position="6958" data-size="0">
<p data-position="6956" data-size="0"><span data-position="6958" data-size="3">(1)</span><br>
<span data-position="6964" data-size="36">CUDA的實作方式與Open CL的版本差異不大，只是程式環境不大一樣。</span><br>
<span data-position="7003" data-size="91">HW5的作業已經有給CUDA程式編譯用的makefile，為了節省時間決定將CUDA的版本實作在HW5的環境上，只需要在main做點更動並在kernel.cu實作出程式內容就完成了。</span></p>
<p data-position="7104" data-size="0"><span data-position="7108" data-size="5">實作方法:</span></p>
<ul>
<li class="" data-startline="239" data-endline="239" data-position="7120" data-size="0"><span data-position="7120" data-size="16">將傳輸資料量縮小(改變資料型態)</span></li>
<li class="" data-startline="240" data-endline="240" data-position="7143" data-size="0"><span data-position="7143" data-size="9">修改for迴圈寫法</span></li>
<li class="" data-startline="241" data-endline="242" data-position="7159" data-size="0"><span data-position="7159" data-size="11">修剪filter的大小</span><font color="red"><span data-position="7188" data-size="4">(動態)</span></font></li>
</ul>
<p data-position="7201" data-size="0"><span data-position="7205" data-size="62">有些優化方式在CUDA沒有明顯的效益，所以沒有把它實作上去，在做性能評估時，Open CL的版本會下修為CUDA實作的方法。</span></p>
<pre><code class="cpp hljs"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;cuda.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BLOCK_SIZE</span> <span class="token expression"><span class="token number">8</span></span></span>

__global__ <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">convolution</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>inputImage<span class="token punctuation">,</span> <span class="token keyword">unsigned</span> <span class="token keyword">short</span> <span class="token operator">*</span>outputImage<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>filter<span class="token punctuation">,</span> <span class="token keyword">int</span> filter_width<span class="token punctuation">,</span> <span class="token keyword">int</span> image_width<span class="token punctuation">,</span> <span class="token keyword">int</span> image_height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> halffilter_size <span class="token operator">=</span> filter_width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> blockIdx<span class="token punctuation">.</span>y <span class="token operator">*</span> blockDim<span class="token punctuation">.</span>y <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    <span class="token keyword">int</span> col <span class="token operator">=</span> blockIdx<span class="token punctuation">.</span>x <span class="token operator">*</span> blockDim<span class="token punctuation">.</span>x <span class="token operator">+</span> threadIdx<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> k_start <span class="token operator">=</span> <span class="token operator">-</span>halffilter_size <span class="token operator">+</span> row <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span>halffilter_size <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> k_end <span class="token operator">=</span> halffilter_size <span class="token operator">+</span> row <span class="token operator">&lt;</span> image_height <span class="token operator">?</span> halffilter_size <span class="token operator">:</span> halffilter_size <span class="token operator">+</span> row <span class="token operator">-</span> image_height <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> l_start <span class="token operator">=</span> <span class="token operator">-</span>halffilter_size <span class="token operator">+</span> col <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token operator">-</span>halffilter_size <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> l_end <span class="token operator">=</span> halffilter_size <span class="token operator">+</span> col <span class="token operator">&lt;</span> image_width <span class="token operator">?</span> halffilter_size <span class="token operator">:</span> halffilter_size <span class="token operator">+</span> col <span class="token operator">-</span> image_width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k <span class="token operator">=</span> k_start<span class="token punctuation">;</span> k <span class="token operator">&lt;=</span> k_end<span class="token punctuation">;</span> <span class="token operator">++</span>k<span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> l_start<span class="token punctuation">;</span> l <span class="token operator">&lt;=</span> l_end<span class="token punctuation">;</span> <span class="token operator">++</span>l<span class="token punctuation">)</span> 
            sum <span class="token operator">+=</span> inputImage<span class="token punctuation">[</span><span class="token punctuation">(</span>row <span class="token operator">+</span> k<span class="token punctuation">)</span> <span class="token operator">*</span> image_width <span class="token operator">+</span> col <span class="token operator">+</span> l<span class="token punctuation">]</span> <span class="token operator">*</span> filter<span class="token punctuation">[</span><span class="token punctuation">(</span>k <span class="token operator">+</span> halffilter_size<span class="token punctuation">)</span> <span class="token operator">*</span> filter_width <span class="token operator">+</span> l <span class="token operator">+</span> halffilter_size<span class="token punctuation">]</span><span class="token punctuation">;</span>

    outputImage<span class="token punctuation">[</span>row <span class="token operator">*</span> image_width <span class="token operator">+</span> col<span class="token punctuation">]</span> <span class="token operator">=</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">check_filter</span><span class="token punctuation">(</span><span class="token keyword">float</span> <span class="token operator">*</span>filter<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>char_filter<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>filter_width<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> check_row <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> new_filter_width <span class="token operator">=</span> <span class="token operator">*</span>filter_width<span class="token punctuation">;</span>
    <span class="token keyword">int</span> check_start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> check_end <span class="token operator">=</span> <span class="token operator">*</span>filter_width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">bool</span> check <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>check <span class="token operator">&amp;&amp;</span> check_start <span class="token operator">&lt;</span> check_end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token operator">*</span>filter_width <span class="token operator">&amp;&amp;</span> check<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>filter<span class="token punctuation">[</span>check_start <span class="token operator">*</span> <span class="token operator">*</span>filter_width <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> check <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment">// upper</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token operator">*</span>filter_width <span class="token operator">&amp;&amp;</span> check<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>filter<span class="token punctuation">[</span>check_end <span class="token operator">*</span> <span class="token operator">*</span>filter_width <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> check <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment">// lower</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token operator">*</span>filter_width <span class="token operator">&amp;&amp;</span> check<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>filter<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token operator">*</span>filter_width <span class="token operator">+</span> check_start<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> check <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment">// left</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token operator">*</span>filter_width <span class="token operator">&amp;&amp;</span> check<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token keyword">if</span><span class="token punctuation">(</span>filter<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token operator">*</span>filter_width <span class="token operator">+</span> check_end<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> check <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token comment">// right</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>check<span class="token punctuation">)</span> new_filter_width <span class="token operator">-=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        check_start<span class="token operator">++</span><span class="token punctuation">;</span>
        check_end<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> char_filter_start <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">*</span>filter_width <span class="token operator">-</span> new_filter_width<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token operator">*</span>filter_width <span class="token operator">-</span> new_filter_width<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> new_filter_width<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> new_filter_width<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>
            char_filter<span class="token punctuation">[</span>i <span class="token operator">*</span> new_filter_width <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> filter<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>char_filter_start <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token operator">*</span>filter_width<span class="token punctuation">)</span> <span class="token operator">+</span> char_filter_start <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token operator">*</span>filter_width <span class="token operator">=</span> new_filter_width<span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Host front-end function that allocates the memory and launches the GPU kernel</span>
<span class="token keyword">void</span> <span class="token function">hostFE</span> <span class="token punctuation">(</span><span class="token keyword">int</span> filterWidth<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span> filter<span class="token punctuation">,</span> <span class="token keyword">int</span> imageHeight<span class="token punctuation">,</span> <span class="token keyword">int</span> imageWidth<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span> inputImage<span class="token punctuation">,</span> <span class="token keyword">float</span> <span class="token operator">*</span> outputImage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> image_size <span class="token operator">=</span> imageHeight <span class="token operator">*</span> imageWidth<span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token operator">*</span>char_filter <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>filterWidth <span class="token operator">*</span> filterWidth <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>uchar_input <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>image_size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">short</span> <span class="token operator">*</span>short_output <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">short</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>image_size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">short</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> image_size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> uchar_input<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> inputImage<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">check_filter</span><span class="token punctuation">(</span>filter<span class="token punctuation">,</span> char_filter<span class="token punctuation">,</span> <span class="token operator">&amp;</span>filterWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">char</span> <span class="token operator">*</span>device_filter<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>device_input<span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">short</span> <span class="token operator">*</span>device_output<span class="token punctuation">;</span>
    <span class="token function">cudaMalloc</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>device_filter<span class="token punctuation">,</span> filterWidth <span class="token operator">*</span> filterWidth <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cudaMalloc</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>device_input<span class="token punctuation">,</span> image_size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cudaMalloc</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>device_output<span class="token punctuation">,</span> image_size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">short</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cudaMemcpy</span><span class="token punctuation">(</span>device_filter<span class="token punctuation">,</span> char_filter<span class="token punctuation">,</span> filterWidth <span class="token operator">*</span> filterWidth <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cudaMemcpyHostToDevice<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cudaMemcpy</span><span class="token punctuation">(</span>device_input<span class="token punctuation">,</span> uchar_input<span class="token punctuation">,</span> image_size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cudaMemcpyHostToDevice<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">int</span> x_blocks <span class="token operator">=</span> imageWidth <span class="token operator">/</span> BLOCK_SIZE<span class="token punctuation">;</span>
    <span class="token keyword">int</span> y_blocks <span class="token operator">=</span> imageHeight <span class="token operator">/</span> BLOCK_SIZE<span class="token punctuation">;</span>
    dim3 <span class="token function">block_size</span><span class="token punctuation">(</span>BLOCK_SIZE<span class="token punctuation">,</span> BLOCK_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dim3 <span class="token function">num_block</span><span class="token punctuation">(</span>x_blocks<span class="token punctuation">,</span> y_blocks<span class="token punctuation">)</span><span class="token punctuation">;</span>
    convolution<span class="token operator">&lt;&lt;</span><span class="token operator">&lt;</span>num_block<span class="token punctuation">,</span> block_size<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>device_input<span class="token punctuation">,</span> device_output<span class="token punctuation">,</span> device_filter<span class="token punctuation">,</span> filterWidth<span class="token punctuation">,</span> imageWidth<span class="token punctuation">,</span> imageHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cudaMemcpy</span><span class="token punctuation">(</span>short_output<span class="token punctuation">,</span> device_output<span class="token punctuation">,</span> image_size <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">short</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cudaMemcpyDeviceToHost<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">register</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> image_size<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> outputImage<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>short_output<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token function">cudaFree</span><span class="token punctuation">(</span>device_filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cudaFree</span><span class="token punctuation">(</span>device_input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cudaFree</span><span class="token punctuation">(</span>device_output<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">free</span><span class="token punctuation">(</span>char_filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>uchar_input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">free</span><span class="token punctuation">(</span>short_output<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
<li class="" data-startline="327" data-endline="332" data-position="11758" data-size="0">
<p data-position="11756" data-size="0"><span data-position="11758" data-size="3">(2)</span><br>
<span data-position="11764" data-size="42">帶入的filter剛好都可以修剪為3*3的大小，所以效能評估上只做一個執行指令的比較。</span><br>
<span data-position="11810" data-size="12">執行指令: ./conv</span><br>
<font color="red"><span data-position="11843" data-size="38">此Open CL版本是比照CUDA的優化方式另外寫的，上傳的般本會與此不同。</span></font><br>
<img src="./OpenCL Programming - HackMD_files/6lPqKvU.png" alt="" class="" data-position="11891" data-size="36" loading="lazy"></p>
</li>
<li class="" data-startline="333" data-endline="361" data-position="11939" data-size="0">
<p data-position="11937" data-size="0"><span data-position="11939" data-size="3">(3)</span><br>
<span data-position="11945" data-size="80">原本預期CUDA會比較快一點，因為GPU是nvidia的，下意識會認為相容性、效能、優化等…會使結果"明顯"優於Open CL，但以實驗結果來看差異並不大。</span></p>
<p data-position="12033" data-size="0"><span data-position="12038" data-size="10">上網查了一下資料發現</span><a href="https://arxiv.org/vc/arxiv/papers/1005/1005.2581v1.pdf" target="_blank" rel="noopener"><span data-position="12048" data-size="4">這篇論文</span></a><span data-position="12109" data-size="15">有對兩個架構的效能差異做分析。</span><br>
<span data-position="12127" data-size="9">以下節錄幾個重點:</span></p>
<blockquote class="">
<p data-position="12145" data-size="0"><span data-position="12145" data-size="60">We tested CUDA and OpenCL versions of our application on an </span><strong data-position="12205" data-size="0"><span data-position="12207" data-size="6">NVIDIA</span></strong><span data-position="12215" data-size="16"> GeForce GTX260.</span></p>
</blockquote>
<blockquote class="">
<p data-position="12239" data-size="0"><strong data-position="12239" data-size="0"><span data-position="12241" data-size="40">OpenCL kernel can be compiled at runtime</span></strong><span data-position="12283" data-size="92">, which would add to an OpenCL’s running time. On the other hand, this just-in-time compile </span><strong data-position="12375" data-size="0"><span data-position="12377" data-size="79">may allow the compiler to generate code that makes better use of the target GPU</span></strong><span data-position="12458" data-size="1">.</span></p>
</blockquote>
<blockquote class="">
<p data-position="12472" data-size="0"><strong data-position="12472" data-size="0"><span data-position="12474" data-size="241">CUDA, on the other hand, is developed by the same company that develops the hardware on which it executes, so one may expect it to better match thecomputing characteristics of the GPU, offering more access to features and better performance.</span></strong><span data-position="12717" data-size="122"> Considering these factors, it is of interest to compare OpenCL’s performance to that of CUDA in a real-world application.</span></p>
</blockquote>
<blockquote class="">
<p data-position="12851" data-size="0"><span data-position="12851" data-size="23">In this paper we use a </span><strong data-position="12874" data-size="0"><span data-position="12876" data-size="25">computationally-intensive</span></strong><span data-position="12903" data-size="96"> scientific application to provide a performance comparison of CUDA and OpenCL on an NVIDIA GPU.</span></p>
</blockquote>
<blockquote class="">
<p data-position="13011" data-size="0"><span data-position="13011" data-size="18">For this paper we </span><strong data-position="13029" data-size="0"><span data-position="13031" data-size="45">optimized the kernel’s memory access patterns</span></strong><span data-position="13078" data-size="296">. We then ported the CUDA kernel to OpenCL, a process which, with NVIDIA development tools, required minimal code changes in the kernel itself, as explained below. Other related code, for example to detect and setup the GPU or to copy data to and from the GPU, needed to be re-written for OpenCL.</span></p>
</blockquote>
<p data-position="13376" data-size="0"><img src="./OpenCL Programming - HackMD_files/ouj0Q47.png" alt="" class="" data-position="13380" data-size="36" loading="lazy"><br>
<img src="./OpenCL Programming - HackMD_files/vDvjIlw.png" alt="" class="" data-position="13419" data-size="36" loading="lazy"><br>
<img src="./OpenCL Programming - HackMD_files/ThqdoUg.png" alt="" class="" data-position="13458" data-size="36" loading="lazy"></p>
<p data-position="13501" data-size="0"><span data-position="13505" data-size="43">由結果可以發現，在資料傳輸與計算方面CUDA皆是優於Open CL，但這個實驗是建構在</span><strong data-position="13548" data-size="0"><span data-position="13550" data-size="25">computationally-intensive</span></strong><span data-position="13577" data-size="18">的實驗目標且對實作上有做最佳化處理。</span><br>
<span data-position="13598" data-size="38">回顧到之前的卷積作法只是以3*3的filter去做圖像處理，計算量是相對少的，</span><strong data-position="13641" data-size="0"><span data-position="13639" data-size="62">儘管資料傳輸方面CUDA是優於Open CL，但在計算方面較難展現出明顯的差異，可能導致時間上與Open CL的做法差異不大</span></strong><span data-position="13703" data-size="31">。此外，時間的差異也有可能是因為沒有最佳化CUDA的寫法所致。</span></p>
<p data-position="13742" data-size="0"><span data-position="13746" data-size="46">除了實驗結果外，在實作方面，以上手難度而言我認為Open CL &gt; CUDA，主要分為兩項:</span></p>
<ol data-position="13797" data-size="0">
<li class="" data-startline="357" data-endline="357" data-position="13800" data-size="0"><span data-position="13800" data-size="41">Open CL的前置作業比較多(由作業中helper.c的initCL()可看出)</span></li>
<li class="" data-startline="358" data-endline="359" data-position="13849" data-size="0"><span data-position="13849" data-size="36">網路資源較少(畢竟在效能上輸CUDA，顯卡的主流又是以nvidia為主)</span></li>
</ol>
<p data-position="13887" data-size="0"><span data-position="13891" data-size="26">未來若需要做GPU的計算我會以CUDA作為優先考量。</span></p>
</li>
</ul></div>

    <div class="document-footer container-fluid hmd-pb-2 hidden-print">
        <div class="flex items-center justify-end -mb-5 text-right text-gray-500 text-3">
            <span>
                最後編輯：
                &nbsp;
            </span>

            
                <span class="ui-lastchangeuser h-[18px]" data-profile="karta134033" data-placement="left">
                    <a class="ui-user-icon inline-block w-[18px] h-[18px] m-0 user-card-popover" style="background-image: url(https://lh3.googleusercontent.com/-8t6tJ5N_q9k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reKpEqiLF5J4yGnqMw6Ckn2daGTog/photo.jpg);" target="_blank" href="https://hackmd.io/@karta134033" data-toggle="popover" data-original-title="" title=""></a>
                </span>
            
        </div>

        <hr class="my-7.5">
        <div class="flex flex-col-reverse footer hmd-items-center sm:flex-row gap-[25px] sm:gap-0">
    <div class="flex-1 block h-full">
        <div class="flex gap-3">
    
        <span class="flex items-center justify-center ui-owner" data-placement="top" data-profile="karta134033">
             <a class="inline-block w-10 h-10 m-0 min-w-10 ui-user-icon user-card-popover" style="background-image: url(https://lh3.googleusercontent.com/-8t6tJ5N_q9k/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reKpEqiLF5J4yGnqMw6Ckn2daGTog/photo.jpg);" target="_blank" href="https://hackmd.io/@karta134033" data-toggle="popover" data-original-title="" title=""></a>
        </span>
    


    <div class="flex flex-col max-w-[303px] gap-1.5 justify-center items-start">
        
            <a class="font-bold ui-owner text-5 text-black-brand user-card-popover" hover:underline="" cursor-pointer"="" data-profile="karta134033" href="https://hackmd.io/@karta134033" data-toggle="popover" data-original-title="" title="">
                karta134033
            </a>
        

        
            <span class="text-gray-600 text-3">
                
            </span>
            
    </div>
</div>

    </div>

    <div class="footer__views">
        <span class="mr-4">
            <i class="fa fa-eye"></i> <span class="ui-viewcount" title="573">573</span>
        </span>

    
        <span class="community-button ui-like" data-toggle="tooltip" data-placement="top" title="" data-original-title="讚賞">
            <i class="fa fa-fw"></i>
            <span class="count"></span>
        </span>

        <span class="community-button ui-bookmark" data-toggle="tooltip" data-placement="top" title="" data-original-title="收藏">
            <i class="fa fa-fw"></i>
        </span>

        
            <div class="ui-notification dropup dropdown ">
                <span id="notificationLabel" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                    <div class="community-button" data-toggle="tooltip" data-placement="top" title="" data-original-title="訂閱">
                        <i class="fa fa-fw fa-bell"></i>
                    </div>
                </span>

                <ul class="dropdown-menu pull-right" aria-labelledby="notificationLabel">
                    <li class="ui-notification-watch notification-menu-item "><i class="fa fa-check fa-fw"></i><i class="fa fa-bell fa-fw"></i><div class="info"><div class="title">所有通知</div><div class="description">當有任何變更時將會收到通知</div></div></li>
                    <li class="ui-notification-mention notification-menu-item "><i class="fa fa-check fa-fw"></i><i class="fa fa-at fa-fw"></i><div class="info"><div class="title">提及我</div><div class="description">當有人提及我時才會收到通知</div></div></li>
                    <li class="divider"></li>
                    <!--
                        <li class="ui-notification-list notification-menu-item"><span><a href="#"><i class="fa fa-list-ul fa-fw"></i>我的訂閱列表</a></span></li>
                    -->
                    <li class="ui-notification-unsubscribe notification-menu-item">
                        <i class="fa fa-bell-slash-o fa-fw"></i>
                        取消訂閱
                    </li>
                </ul>
                <span class="ui-notification-subscribe community-button" data-toggle="tooltip" data-placement="top" title="" data-original-title="訂閱">
                    <i class="fa fa-fw fa-bell-o"></i>
                </span>
            </div>
        
    
    </div>
</div>

<section id="notes-recommendations">
    
        <hr class="my-7.5">

        <h3 class="mx-0 mb-[35px] text-gray-600 font-bold text-6">閱讀更多</h3>

        <div class="flex flex-col gap-5 sm:grid sm:grid-cols-2">
            
                <a class="pb-7.5 border-b border-gray-200 border-0 border-solid hover:no-underline active:no-underline focus:no-underline ui-recommendation-note" href="https://hackmd.io/@karta134033/Byv-aYzMS?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener">
                    <h5 class="font-bold text-6 text-gray-850 my-0 mb-[5px]">Git Command</h5>

                    <p class="mb-0 leading-[20px] text-gray-500 break-words line-clamp-2 text-5">暫存修改的檔案
git stash   
git stash clear    # 清除暫存
git stash apply    # 加入最近的一次  

增加遠端連線
git remote add upstream git@github.com:gomaji/www.gomaji.com.git   

刪除改過的資料
</p>

                    <small class="mt-3 text-gray-600 text-3" data-moment="2021-10-15T00:45:08.368Z">2021年10月15日</small>
                </a>
            
                <a class="pb-7.5 border-b border-gray-200 border-0 border-solid hover:no-underline active:no-underline focus:no-underline ui-recommendation-note" href="https://hackmd.io/@karta134033/HJ4NmlaLL?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener">
                    <h5 class="font-bold text-6 text-gray-850 my-0 mb-[5px]">資料庫助教課程  專題</h5>

                    <p class="mb-0 leading-[20px] text-gray-500 break-words line-clamp-2 text-5">課程影片
https://drive.google.com/file/d/1ikLY23qbJBHw7ysVpgQjqBIQEvAAKEOb/view?usp=sharing

Demo網址
主要以PC端網頁呈現為主，手機的版型未製作但功能仍可使用。
http://neil.nctu.me/php_project_demo/views/blog.php
註:此網頁內容與下面的專案是相同的，若遇到網頁無法開啟(server主機掛了)則請以以下的方式在local端開啟為主。

使用方法
</p>

                    <small class="mt-3 text-gray-600 text-3" data-moment="2021-06-26T05:26:04.843Z">2021年6月26日</small>
                </a>
            
                <a class="pb-7.5 border-b border-gray-200 border-0 border-solid hover:no-underline active:no-underline focus:no-underline ui-recommendation-note" href="https://hackmd.io/@karta134033/Sko49z6oU?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener">
                    <h5 class="font-bold text-6 text-gray-850 my-0 mb-[5px]">PHP websocket</h5>

                    <p class="mb-0 leading-[20px] text-gray-500 break-words line-clamp-2 text-5">前置作業

到 https://github.com/qqqian0819/chatRoom 把專案載下來，將專案解壓縮到xampp/htdocs資料夾內

到以下位置點開php.ini

找到;extension=sockets的擴充指令,   然後把前面的 ";" 刪掉後儲存關閉

完成以上動作後重啟xampp
</p>

                    <small class="mt-3 text-gray-600 text-3" data-moment="2021-05-19T04:32:13.802Z">2021年5月19日</small>
                </a>
            
                <a class="pb-7.5 border-b border-gray-200 border-0 border-solid hover:no-underline active:no-underline focus:no-underline ui-recommendation-note" href="https://hackmd.io/@karta134033/HJ4vSVjnP?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener">
                    <h5 class="font-bold text-6 text-gray-850 my-0 mb-[5px]">CUDA Programming</h5>

                    <p class="mb-0 leading-[20px] text-gray-500 break-words line-clamp-2 text-5">Q1

What are the pros and cons of the three methods? Give an assumption about their performances.

Host 記憶體配置對比

malloc

優點:
</p>

                    <small class="mt-3 text-gray-600 text-3" data-moment="2021-01-10T07:22:13.813Z">2021年1月10日</small>
                </a>
            
        </div>

        
        

        
            <div class="text-center mt-[35px]">
                <a href="https://hackmd.io/@karta134033?utm_source=preview-mode&amp;utm_medium=rec" target="_blank" rel="noopener" class="font-bold text-gray-500 btn btn-default btn-md ui-recommendation-read-more">
                    閱讀更多 karta134033 的文章
                </a>
            </div>
        
    
</section>


<hr class="mt-7.5 mb-3.5">

<div class="footer text-[15px] text-gray-700 text-center">
    <span>發表於</span> <strong><a href="https://hackmd.io/" target="_blank"><i class="fa fa-file-text"></i> <span class="brand">HackMD</span></a></strong>
</div>

    </div>

    <div class="ui-community unselectable hidden-print hidden-xs" style="display: none; left: 849.5px;">
        
            <div class="community-button ui-like" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" data-original-title="讚賞"><i class="fa fa-fw"></i><div class="count"></div></div>
            <div class="community-button ui-bookmark" title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" data-original-title="收藏"><i class="fa fa-fw"></i></div>
            
                <div class="ui-notification dropup dropdown " title="" data-toggle="tooltip" data-placement="right" data-offset="0,5" data-original-title="訂閱">
                    <div id="notificationLabel" class="community-button" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                        <div class="ui-notification-status"><i class="fa fa-fw fa-bell"></i></div>
                    </div>
                    <ul class="dropdown-menu left" aria-labelledby="notificationLabel">
                        <li class="ui-notification-watch notification-menu-item "><i class="fa fa-check fa-fw"></i><i class="fa fa-bell fa-fw"></i><div class="info"><div class="title">所有通知</div><div class="description">當有任何變更時將會收到通知</div></div></li>
                        <li class="ui-notification-mention notification-menu-item "><i class="fa fa-check fa-fw"></i><i class="fa fa-at fa-fw"></i><div class="info"><div class="title">提及我</div><div class="description">當有人提及我時才會收到通知</div></div></li>
                        <li class="divider"></li>
                        <!--
                           <li class="ui-notification-list notification-menu-item"><span><a href="#"><i class="fa fa-list-ul fa-fw"></i>我的訂閱列表</a></span></li>
                        -->
                        <li class="ui-notification-unsubscribe notification-menu-item"><i class="fa fa-bell-slash-o fa-fw"></i>取消訂閱</li>
                    </ul>
                    <div class="ui-notification-subscribe community-button"><i class="fa fa-fw fa-bell-o"></i></div>
                </div>
            
        
    </div>

    <div class="ui-toc dropup unselectable hidden-print" style="display: none; left: 855.141px;">
        <div class="pull-left dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="https://hackmd.io/@karta134033/rJm2caS6v#" role="button" aria-haspopup="true" aria-expanded="false" title="目錄">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel"><div class="toc"><ul class="nav">
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#OpenCL-Programming" title="OpenCL Programming" smoothhashscroll="">OpenCL Programming</a><ul class="nav">
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#Q1" title="Q1" smoothhashscroll="">Q1</a><ul class="nav">
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#%E2%80%93%E4%BD%9C%E6%B3%95%E2%80%93" title="–作法–" smoothhashscroll="">–作法–</a></li>
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#%E2%80%93%E6%B8%AC%E8%A9%A6%E2%80%93" title="–測試–" smoothhashscroll="">–測試–</a></li>
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#%E2%80%93%E8%A3%9C%E5%85%85%E2%80%93" title="–補充–" smoothhashscroll="">–補充–</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#Q2" title="Q2" smoothhashscroll="">Q2</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@karta134033/rJm2caS6v#">全部展開</a><a class="back-to-top" href="https://hackmd.io/@karta134033/rJm2caS6v#">回到頂部</a><a class="go-to-bottom" href="https://hackmd.io/@karta134033/rJm2caS6v#">移至底部</a></div></ul>
        </div>
    </div>

    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print affix" data-spy="affix" style="top: 77px; left: 507.5px; width: 891.5px;"><div class="toc"><ul class="nav">
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#OpenCL-Programming" title="OpenCL Programming" smoothhashscroll="">OpenCL Programming</a><ul class="nav">
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#Q1" title="Q1" smoothhashscroll="">Q1</a><ul class="nav">
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#%E2%80%93%E4%BD%9C%E6%B3%95%E2%80%93" title="–作法–" smoothhashscroll="">–作法–</a></li>
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#%E2%80%93%E6%B8%AC%E8%A9%A6%E2%80%93" title="–測試–" smoothhashscroll="">–測試–</a></li>
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#%E2%80%93%E8%A3%9C%E5%85%85%E2%80%93" title="–補充–" smoothhashscroll="">–補充–</a></li>
</ul>
</li>
<li><a href="https://hackmd.io/@karta134033/rJm2caS6v#Q2" title="Q2" smoothhashscroll="">Q2</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="https://hackmd.io/@karta134033/rJm2caS6v#">全部展開</a><a class="back-to-top" href="https://hackmd.io/@karta134033/rJm2caS6v#">回到頂部</a><a class="go-to-bottom" href="https://hackmd.io/@karta134033/rJm2caS6v#">移至底部</a></div></div>
    

    <div class="clearfix"></div>

    <!-- signin modal -->
<div class="modal fade signin-modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: 10px; right: 20px; position: absolute;"><span aria-hidden="true">×</span></button>
            






    







<h3>登入</h3>

<form data-toggle="validator" role="form" class="form-horizontal" method="post" enctype="application/x-www-form-urlencoded" id="signin-form" novalidate="true" data-bitwarden-watching="1">
    <div class="hmd-dn"><input type="hidden" name="_csrf" value="NqGIEdyi-97mKgzoseMhfA88yhm9l6e7Q4Ls"></div>
    <div class="hmd-dn"><input type="hidden" name="create_team" value="false"></div>
    <div class="hmd-dn"><input type="hidden" name="create_paid_team" value="false"></div>
    <div class="form-group  ">
        <label for="email" class="control-label">Email</label>
        <label for="inputEmail" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="display: inline;"></span>
        <div class="input-block">
            
                <input type="email" class="form-control" name="email" placeholder="您的 Email" required="" autocomplete="email">
            
            <span class="error-sign"></span>
        </div>
    </div>
    <div class="form-group ">
        <label for="password" class="control-label">密碼</label>
        <label for="inputPassword" class="control-label pull-right errors">
            
        </label>
        <span class="help-block control-label with-errors pull-right" style="display: inline;"></span>
        <div class="input-block">
            <input type="password" class="form-control" name="password" placeholder="您的密碼" required="" autocomplete="current-password">
            <span class="error-sign"></span>
            
                <span class="control-label pull-right" style="font-size: 13px; margin-top: 5px;"><a href="https://hackmd.io/settings/forgotPassword" style="text-decoration: underline;">忘記密碼</a></span>
            
        </div>
    </div>

    <div style="text-align: center; padding-top: 15px; margin-bottom: 0px;">
        
            <input type="submit" class="btn btn-success btn-large disabled" formaction="https://hackmd.io/login" value="登入" disabled="">
        

        
    </div>
</form>








    
        <p class="separator">或是</p>
    

    
        <p>繼續登入，代表您同意<a href="https://hackmd.io/s/terms" target="_blank">服務條款</a>。</p>
    

    








 



<script id="gsi-client" src="./OpenCL Programming - HackMD_files/client" async="" defer="" nonce=""></script>
<script nonce="">
    function handleCredentialResponse(response) {
        const form = document.getElementById('sign-in-with-google-form')
        form.children.credential.value = response.credential
        form.children.method.value = location.href.toLowerCase() === 'https://hackmd.io/settings#general' ? 'merge' : 'login'
        form.submit()
    }
    var GSI_READY = new Promise(function (resolve) {
        function initialize () {
            google.accounts.id.initialize({
                client_id: '911617723593-drikdibvvn63slfd6kbqigo8ql1no55s.apps.googleusercontent.com',
                callback: handleCredentialResponse
            })
            const loginPath = 'https://hackmd.io/login'
            const joinPath = 'https://hackmd.io/join'
            const renderButton = function () {
                google.accounts.id.renderButton(
                    document.getElementById('sign-in-with-google-button'),
                    { type: 'standard', width: 250 }
                )
            }
            if (location.href.toLowerCase() === loginPath || location.href.toLowerCase() === joinPath) {
                renderButton()
            } else {
                $('.signin-modal').one('shown.bs.modal', function () {
                    renderButton()
                })
            }
            resolve()
        }

        window.addEventListener('load', function () { initialize() })
    })
</script>
<form class="hidden" id="sign-in-with-google-form" action="https://hackmd.io/auth/google" method="post">
    <input type="hidden" name="credential">
    <input type="hidden" name="method">
</form>
 

<div class="social-buttons-container">
    
    <div id="sign-in-with-google-button"></div>
    
    
    <a href="https://hackmd.io/auth/facebook" class="btn btn-lg btn-block btn-social btn-facebook">
        <i class="fa fa-facebook"></i> 透過 Facebook 登入
    </a>
    
    
    <a href="https://hackmd.io/auth/twitter" class="btn btn-lg btn-block btn-social btn-twitter">
        <i class="fa fa-twitter"></i> 透過 Twitter 登入
    </a>
    
    
    <a href="https://hackmd.io/auth/github" class="btn btn-lg btn-block btn-social btn-github">
        <i class="fa fa-github"></i> 透過 GitHub 登入
    </a>
    
    
    <a href="https://hackmd.io/auth/dropbox" class="btn btn-lg btn-block btn-social btn-dropbox">
        <i class="fa fa-dropbox"></i> 透過 Dropbox 登入
    </a>
    
    
    
</div>





    <div>
        <p>第一次使用 HackMD？ <a href="https://hackmd.io/join">註冊</a></p>
    </div>


            

<style>
  .grecaptcha-badge {
      z-index: 1051;
  }
</style>
<script nonce="">
function lazyLoadRecaptcha () {
  document.querySelector('#signin-form input[type="submit"]').disabled = true

  const siteKey = '6LdtkK4ZAAAAAG1B4iENhmQTce1xNTyHu0GjgnXi'
  const lang = 'zh-TW'
  const src = `https://www.google.com/recaptcha/api.js?render=${siteKey}&hl=${lang}&onload=recaptchaOnloadCallback`

  const observer = new MutationObserver(mutations => {
    if (mutations[0].target.classList.contains('in')) {
      observer.disconnect()
      const head = document.querySelector('head')
      const script = document.createElement('script')
      script.setAttribute('nonce', '888f8028-b563-43cf-909b-827b50eae0ac')
      script.type = 'text/javascript'
      script.src = src
      head.appendChild(script)
    }
  })
  observer.observe(document.querySelector('.signin-modal'), { attributeFilter: ['class'] })
}

function recaptchaOnloadCallback () {
  const siteKey = '6LdtkK4ZAAAAAG1B4iENhmQTce1xNTyHu0GjgnXi'
  grecaptcha.ready(function() {
    document.querySelector('#signin-form input[type="submit"]').disabled = false
    grecaptcha.execute(siteKey, {action: 'login'}).then(function(token) {
      recaptchaCallback(token)
    })
  })
}

function recaptchaCallback (token) {
  const badge = document.querySelector('.grecaptcha-badge')
  const modal = $('.signin-modal')
  modal.on('shown.bs.modal', function() {
      badge.style.visibility = 'visible'
  })
  modal.on('hidden.bs.modal', function() {
      badge.style.visibility = 'hidden'
  })

  var input = document.createElement('input');
  input.setAttribute('type', 'hidden');
  input.setAttribute('name', 'g-recaptcha-response');
  input.setAttribute('value', token);
  document.getElementById('signin-form').appendChild(input);
}

lazyLoadRecaptcha ()
</script>


        </div>
    </div>
</div>

    
    <script src="./OpenCL Programming - HackMD_files/js"></script>
    <script nonce="">
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        let userid = (document.cookie.match('(^|; )userid=([^;]*)')||0)[2];
        gtag('config', 'UA-60728495-1', {'user_id': userid});
        
    </script>


    
<script src="./OpenCL Programming - HackMD_files/bundle.min.js.下載" crossorigin="anonymous"></script>
<script nonce="">Sentry.init({ dsn: 'https://73410f1915d84abc8b2dd1f1aabd1c82@sentry.hackmd.dev/4', environment: 'production', integrations: function (intrus) { return intrus.filter(function (itr) { return itr.name !== 'TryCatch' }) } });</script>


    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLW9Z3"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->



    <script src="./OpenCL Programming - HackMD_files/i18n.js.下載"></script>
     <script src="./OpenCL Programming - HackMD_files/font-vendor.cfc9bbf7f59a24c7e6c4.js.下載" defer="defer"></script><script src="./OpenCL Programming - HackMD_files/common-vendor.4fb39488e38e07ad876b.js.下載" defer="defer"></script><script src="./OpenCL Programming - HackMD_files/pretty-vendor.ae927cc636c64832c2ad.js.下載" defer="defer"></script><script src="./OpenCL Programming - HackMD_files/pretty-common.f2bb7062872855109188.js.下載" defer="defer"></script><script src="./OpenCL Programming - HackMD_files/pretty.336d9995eaac673f4a99.js.下載" defer="defer"></script>

    



<div class="ReactModalPortal"></div><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div></body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>